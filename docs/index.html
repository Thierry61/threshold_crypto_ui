<!DOCTYPE html><html><head><meta charset="utf-8"><title>BLS - Threshold Crypto</title><link rel="stylesheet" href="app.7d485e0c.css"><meta content="BLS threshold crypto interface" name="description"><meta content="width=device-width, initial-scale=1.0" name="viewport"><meta content="Ian Coleman" name="author"><link type="image/x-icon" rel="icon" href="data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAABmJLR0T///////8JWPfcAAAACXBIWXMAAABIAAAASABGyWs+AAAAF0lEQVRIx2NgGAWjYBSMglEwCkbBSAcACBAAAeaR9cIAAAAASUVORK5CYII="></head><body> <p class="version">v0.1.4</p> <h1>BLS Threshold Crypto</h1> <p> Interface for rust library <a href="https://github.com/poanetwork/threshold_crypto">threshold_crypto</a>. Read more about this tool in the <a href="#info">info section</a>. </p> <p> This tool was created to be interoperable with SAFE Network <a href="https://github.com/maidsafe/safe-api">safe-api</a> and <a href="https://github.com/maidsafe/safe-vault">safe-vault</a>. </p> <h1 class="text-red">WARNING: PROTOTYPE</h1> <p class="text-red"> This is a prototype tool and will definitely change in incompatible ways in the future. </p> <p class="text-red"> Do not ever use this tool for anything. </p> <hr> <div id="sk-to-pk"> <h2>Derive Public Key From Secret Key</h2> <p> Input: Secret Key Hex (as per bincode serialization), 32 bytes ie 64 hex chars, or <button class="generate">generate</button> a random key. </p> <input class="sk-hex" placeholder="eg 7b4ecc..."> <p>Output: Public Key Hex, 48 bytes ie 96 hex chars.</p> <input class="pk-hex" placeholder="eg a32fc9..."> <p class="error text-red hidden"></p> </div> <hr> <div id="sign-msg"> <h2>Sign Message</h2> <p> Input: Secret Key Hex (as per bincode serialization), 32 bytes ie 64 hex chars. </p> <input class="sk-hex" placeholder="eg 7b4ecc..."> <p> Input: Message can be any ascii input. Copy and Paste from a text editor rather than typing manually is recommended here. </p> <input class="msg" placeholder="eg This is my message"> <p> Output: The signature for this message will appear here, 96 bytes ie 192 hex chars. </p> <input class="sig" placeholder="Signature will appear here."> <p class="error text-red hidden"></p> <hr> <div id="verify"> <h2>Verify Signature</h2> <p>Input: Public Key Hex, 48 bytes ie 96 hex chars.</p> <input class="pk-hex" placeholder="eg a32fc9..."> <p> Input: Message can be any ascii input. Copy and Paste from a text editor rather than typing manually is recommended here. </p> <input class="msg" placeholder="eg This is my message"> <p> Input: The signature for this message. </p> <input class="sig" placeholder="eg 8ad3c2..."> <p> Output: Whether the signature is valid or not. </p> <input class="valid" placeholder="Will show 'valid' or 'invalid'"> <p class="error text-red hidden"></p> </div> <hr> <div id="encrypt"> <h2>Encrypt Message</h2> <p>Input: Recipient Public Key Hex, 48 bytes ie 96 hex chars.</p> <input class="pk-hex" placeholder="eg a32fc9..."> <p> Input: Message can be any ascii input. Copy and Paste from a text editor rather than typing manually is recommended here. </p> <input class="msg" placeholder="eg This is my message"> <p> Output: The encrypted version of this message for sending to the recipient. </p> <input class="ct" placeholder="Encrypted message will appear here."> <p class="error text-red hidden"></p> </div> <hr> <div id="decrypt"> <h2>Decrypt Message</h2> <p> Input: Secret Key Hex (as per bincode serialization), 32 bytes ie 64 hex chars. </p> <input class="sk-hex" placeholder="eg 7b4ecc..."> <p> Input: The encrypted message (hex encoded). </p> <input class="ct" placeholder="Encrypted message will appear here."> <p> Output: The decrypted message (ascii encoded). </p> <input class="msg" placeholder="eg This is my message"> <p class="error text-red hidden"></p> </div> <hr> <div id="simple-threshold-keys"> <h2>Simple Threshold Keys</h2> <p> This type of key generation is useful when one person is in control of all aspects of the keys, eg a multisig wallet. </p> <p> Input: Poly Hex (as per bincode serialization), or <button class="generate">generate</button> a random poly with threshold <input class="threshold" value="3" type="number" min="2" max="10"> (this is the m in m-of-n). Minimum 2, maximum 10. Make a secure backup of poly if you want to derive key shares in the future. </p> <input class="poly-hex" placeholder="eg 7b4ecc..."> <p> Output: Master Secret Key Hex, 48 bytes ie 96 hex chars. Never used for anything and should never be shared, just shown here for information. </p> <input class="msk-hex" placeholder="eg 39f3bb0..."> <p> Output: Master Public Key Hex, 48 bytes ie 96 hex chars. This is used to verify a combined signature. A group of people will each individually sign a message, then those signatures will be aggregated to produce a combined signature which can be verified with this master public key. </p> <input class="mpk-hex" placeholder="eg a32fc9..."> <p> Show <input class="total-keys" value="7" type="number" min="2" max="10"> key shares (this is the n in m-of-n). </p> <p> Output: Secret Key Shares. Each line is a secret key. </p> <textarea class="skset"></textarea> <p> Output: Public Key Shares. Each line is the public key corresponding to the secret key on each line above. </p> <textarea class="pkset"></textarea> <p class="error text-red hidden"></p> </div> <hr> <div id="dkg-keys"> <h2>Distributed Key Generation (DKG)</h2> <p> A way to generate a group public key by coordinated action rather than a trusted dealer. </p> <p>This is how a group of untrusted nodes (eg elders in a section on the SAFE network) can form a group key without giving away any individual secrets or trusting any individual participant. </p> <p> Some details are not included (such as handling faulty nodes or the encryption of shares) but they can be seen in the <a href="https://github.com/maidsafe/BLS-DKG"> BLS-DKG</a> crate which this example is based on, as well as <a href="https://github.com/dashpay/dips/blob/master/dip-0006/bls_m-of-n_threshold_scheme_and_dkg.md#distributed-key-generation-dkg-protocol"> DIP-0006</a> which BLS-DKG is based on. There is also <a href="https://github.com/poanetwork/threshold_crypto/blob/d81953b55d181311c2a4eed2b6c34059fcf3fdae/src/poly.rs#L967"> an example of DKG</a> in the threshold_crypto crate. </p> <p> Input: Shares Matrix - <button class="generate">Generate</button> a group of <input class="total-nodes" type="number" min="3" max="10" value="4"> nodes with at least <input class="threshold" type="number" min="2" max="10" value="2"> nodes required to sign or decrypt messages (maximum 10 nodes). </p> <p class="error text-red hidden"></p> <p> Output: The group master public key used for encrypting and verifying messages. This is generated in Step 5, shown below the table, but is shown here because it's known by all participants. </p> <input class="mpk-hex" placeholder="eg a32fc9..."> <p> Hover on a cell, the details of the relevant shares will display below the table. </p> <p> Click a cell to retain the details while scrolling, click again to unlock. </p> <p> Cell F3T2 should be read as "Share sent <b>F</b>rom node <b>3</b> <b>T</b>o node <b>2</b>". </p> <p> Every node is responsible for generating their row of shares in the table, and combining their column of received shares. </p> <table class="shares"><tbody>  <tr> <td>F1T1</td><td>F1T2</td><td>F1T3</td><td>F1T4</td> </tr> <tr> <td>F2T1</td><td>F2T2</td><td>F2T3</td><td>F2T4</td> </tr> <tr> <td>F3T1</td><td>F3T2</td><td>F3T3</td><td>F3T4</td> </tr> <tr> <td>F4T1</td><td>F4T2</td><td>F4T3</td><td>F4T4</td> </tr> </tbody></table> <p> Step 1: All nodes generate their own unique secret (called a BivarPoly). This is used to derive the list of shares for the other nodes, shown in Step 2. </p> <p> The value shown below is the public portion of node <span class="sender-id">0</span>'s BivarPoly. The public portion is shared to all nodes and combined into the group master public key in Step 5. </p> <input class="share-creation"> <p> Step 2: Listed below are shares node <span class="sender-id">0</span> will <b>send</b> to every other node. Only node <span class="sender-id">0</span> has this list of shares. </p> <p> These are derived from the secret in Step 1 that only node <span class="sender-id">0</span> knows. </p> <p> Even though only one row is currently highlighted, all rows contribute to the DKG process. </p> <div class="shares-created" contenteditable="true"></div> <p> Step 3: Listed below are shares node <span class="receiver-id">0</span> will <b>receive</b> from every other node. Only node <span class="receiver-id">0</span> has this list of shares. </p> <p> These are used by node <span class="receiver-id">0</span> to generate their secret key share, shown in Step 4. </p> <p> Even though only one column is currently highlighted, all columns contribute to the DKG process. </p> <div class="shares-received" contenteditable="true"></div> <p> Step 4: Secret Key Share for node <span class="receiver-id">0</span>. 32 bytes ie 64 hex chars. This is created by combining the shares received by node <span class="receiver-id">0</span> in Step 3. </p> <input class="skshare-hex" placeholder="eg 9bb286..."> <p> Step 5: The group master public key can be derived by any node by combining all the public portions of the BivarPolys (see Step 1 above and Bonus #2 below). The group master public key is shown above the table. </p> <p> Bonus #1: The complete list of Secret Key Shares is shown below. This would never be seen in real life since each node derives their own secret key from information sent to it by other nodes (see Step 4). But it's handy to have this list here for using elsewhere in this tool. </p> <textarea class="all-skshares"></textarea> <p> Bonus #2: The complete list of BivarPoly public portions - ie <code>BivarPoly.commitment().row(0)</code> - is shown below. This list is known by all nodes, and can be combined to generate the group master public key. </p> <textarea class="all-share-creations"></textarea> <p> Bonus #3: The Master Secret Key Poly is shown below. This would never be seen in real life since no node has all the secrets needed to generate it. But it's handy for using elsewhere in this tool, such as the input for Simple Threshold Keys. </p> <input class="msk-poly-hex"> </div> <hr> <div id="thresh-sig"> <h2>Sign Group Message</h2> <p>Work is in progress...</p> </div> <hr> <div id="thresh-verify"> <h2>Verify Group Signature</h2> <p> Use the master public key from <a href="#simple-threshold-keys">simple threshold keys</a> or <a href="#dkg-keys">DKG keys</a> to verify the signature using the <a href="#verify">verify section</a>. </p> </div> <hr> <div id="thresh-encrypt"> <h2>Encrypt Group Message</h2> <p> Create a master public key using <a href="#simple-threshold-keys">simple threshold keys</a> or <a href="#dkg-keys">DKG keys</a>. </p> <p> Use the master public key to encrypt a message in the <a href="#encrypt">encrypt section</a>. </p> </div> <hr> <div id="thresh-decryption"> <h2>Decrypt Group Message</h2> <p>Work is in progress...</p> </div> <hr> <div id="info"> <h2>Info</h2> <p> This tool is based on <a href="https://github.com/poanetwork/threshold_crypto/tree/7709462f2df487ada3bb3243060504b5881f2628"> threshold_crypto v0.4.0</a>. </p> <p> Since wasm is quite limited in the interface between javascript and rust, this tool uses a rust wrapper around threshold_crypto which is relatively awkward, but this is just an implementation detail. Not all threshold_crypto functions are available in the wasm or this tool. </p> <p> threshold_crypto is very cautious about revealing secret keys. You should be too. You may find the secret keys in this tool are not compatible with other BLS tools. That's probably because secret keys are serialized from threshold_crypto using bincode. </p> <p> threshold_crypto uses curve <a href="https://github.com/poanetwork/threshold_crypto/blob/7709462f2df487ada3bb3243060504b5881f2628/src/lib.rs#L67"> BLS12-381</a>. </p> <p> Since it's not abundantly obvious which source of randomness is used by threshold_crypto in SecretKey::random when compiled to wasm, the tool uses javascript Crypto.getRandomValues which has known assurances around the strength of the random values generated. </p> <p> You can use this tool without having to be online. In your browser, select file save-as, and save this page as a file. Double-click that file to open it in a browser on any offline computer. </p> </div> <script src="convert.2884bb1e.js"></script>  <script src="errors.048c37c3.js"></script> <script src="dkg.635ecd72.js"></script> <script src="js.707bd789.js"></script> </div></body></html>